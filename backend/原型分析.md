# 北京云听音频精修系统 - 原型分析报告

## 一、原型概述

**原型地址**: https://modao.cc/proto/oakOzJNt5hjuc3p2NX5JI/sharing?view_mode=device&screen=rbpV26jSLVVgDkJyO&canvasId=rcV26lh0g5ORjepI

**分析依据**: 
- API接口设计文档
- 数据库设计文档
- 软件技术方案
- TTS系统通用设计模式

---

## 二、核心功能模块分析

### 2.1 任务管理模块

#### 界面布局推测
- **主界面**: 任务列表页面，展示所有任务
- **任务卡片**: 显示任务ID、文本内容预览、字符数、状态、创建时间
- **状态标识**: 
  - 待拆句（灰色）
  - 已拆句（蓝色）
  - 已完成（绿色）

#### 交互流程
1. **创建任务**
   - 顶部有"新建任务"按钮
   - 点击后弹出文本输入框（支持最多2000字）
   - 输入文本后点击"确定"，系统自动拆句
   - 拆句完成后跳转到任务详情页

2. **任务列表**
   - 支持分页显示
   - 支持按状态筛选
   - 支持按时间排序
   - 点击任务卡片进入详情页

3. **任务详情**
   - 显示完整文本内容
   - 显示拆句后的句子列表
   - 显示合并音频播放器（如果已合成）
   - 显示任务状态和操作按钮

---

### 2.2 句子管理模块

#### 界面布局推测
- **句子列表**: 以列表或卡片形式展示所有句子
- **句子项**: 显示序号、内容、字符数、合成状态、音频播放器
- **操作按钮**: 编辑、合成、参数调整、删除等

#### 交互流程
1. **句子列表展示**
   - 按序号顺序排列
   - 每个句子显示：
     - 序号（sequence）
     - 内容（content）
     - 字符数（char_count）
     - 合成状态（synthesis_status）
     - 音频播放器（如果已合成）
     - 操作按钮组

2. **句子详情**
   - 点击句子进入详情页
   - 显示完整句子内容
   - 显示合成参数设置
   - 显示停顿设置列表
   - 显示多音字设置列表
   - 显示SSML配置（可展开/收起）

3. **句子编辑**
   - 支持修改句子内容
   - 支持插入新句子（向下插入）
   - 支持删除句子

---

### 2.3 语音合成模块

#### 界面布局推测
- **合成参数面板**: 音色选择、语速滑块、音量滑块、音调滑块
- **合成按钮**: 单个合成、批量合成、重新合成
- **合成状态**: 进度条、状态提示

#### 交互流程
1. **单个句子合成**
   - 在句子详情页或列表页
   - 选择音色（下拉选择框）
   - 调整语速（滑块：-500到500）
   - 调整音量（滑块：-60到60）
   - 调整音调（滑块：-500到500）
   - 点击"合成"按钮
   - 显示合成状态（合成中、已完成、失败）
   - 合成完成后显示音频播放器

2. **批量合成**
   - 在任务详情页
   - 勾选需要合成的句子
   - 设置统一的合成参数
   - 点击"批量合成"
   - 显示批量合成进度
   - 完成后所有句子显示音频播放器

3. **重新合成**
   - 对已合成的句子
   - 修改参数后点击"重新合成"
   - 覆盖原有音频

---

### 2.4 参数调整模块

#### 界面布局推测
- **参数调整面板**: 侧边栏或弹窗形式
- **参数控件**: 
  - 音色选择器（下拉菜单，显示音色名称和类型）
  - 语速滑块（带数值显示）
  - 音量滑块（带数值显示）
  - 音调滑块（带数值显示）
- **实时预览**: 调整参数后可预览效果

#### 交互流程
1. **打开参数调整**
   - 点击句子上的"参数调整"按钮
   - 弹出参数调整面板

2. **调整参数**
   - 选择音色：下拉选择，显示推荐音色
   - 调整语速：拖动滑块，实时显示数值（-500到500）
   - 调整音量：拖动滑块，实时显示数值（-60到60）
   - 调整音调：拖动滑块，实时显示数值（-500到500）

3. **保存参数**
   - 点击"保存"按钮
   - 参数保存到数据库
   - SSML配置自动更新
   - 提示"参数已保存，需要重新合成才能生效"

---

### 2.5 停顿和静音模块

#### 界面布局推测
- **句子文本显示**: 可点击的文本区域
- **停顿标记**: 在文本上显示停顿位置标记
- **停顿设置面板**: 显示所有停顿列表，可编辑/删除

#### 交互流程
1. **添加停顿**
   - 在句子文本上点击位置
   - 弹出停顿设置弹窗
   - 设置停顿时长（毫秒，如500ms）
   - 选择类型（停顿/静音）
   - 点击"确定"
   - 文本上显示停顿标记

2. **查看停顿列表**
   - 在句子详情页显示停顿列表
   - 显示位置、时长、类型
   - 支持编辑和删除

3. **删除停顿**
   - 点击停顿列表中的删除按钮
   - 或点击文本上的停顿标记删除

---

### 2.6 多音字处理模块

#### 界面布局推测
- **多音字高亮**: 在句子文本中高亮显示多音字
- **多音字设置面板**: 显示所有多音字设置
- **读音选择器**: 弹出选择读音（拼音）

#### 交互流程
1. **设置多音字**
   - 在句子文本中点击多音字
   - 弹出读音选择器
   - 显示该字的所有读音选项
   - 选择正确的读音
   - 点击"确定"
   - 文本中该字显示特殊标记

2. **查看多音字设置**
   - 在句子详情页显示多音字列表
   - 显示字符、位置、读音
   - 支持编辑和删除

3. **删除多音字设置**
   - 点击多音字列表中的删除按钮
   - 或点击文本上的多音字标记删除

---

### 2.7 阅读规范模块

#### 界面布局推测
- **阅读规范列表**: 显示全局规范和任务规范
- **规范项**: 显示匹配模式、规则类型、规则值、作用域
- **创建规范**: 弹窗表单

#### 交互流程
1. **创建阅读规范**
   - 点击"创建阅读规范"按钮
   - 弹出创建表单
   - 输入匹配模式（如"2025"）
   - 选择规则类型（数字读法、日期读法、符号读法等）
   - 输入规则值（如"二零二五"）
   - 选择作用域（全局/任务）
   - 点击"确定"

2. **应用阅读规范**
   - 在任务详情页
   - 点击"应用阅读规范"
   - 选择要应用的规范
   - 系统自动匹配并应用
   - 显示应用结果

3. **查看规范应用**
   - 在句子详情页
   - 显示已应用的阅读规范
   - 显示匹配到的文本和位置

---

### 2.8 音频编辑模块

#### 界面布局推测
- **音频播放器**: 显示音频波形或进度条
- **合并音频播放器**: 显示整个任务的合并音频
- **编辑工具栏**: 插入句子、合并音频等按钮

#### 交互流程
1. **插入句子**
   - 在句子列表中点击"插入"按钮
   - 弹出插入表单
   - 输入新句子内容
   - 选择音色（默认与上一句相同）
   - 点击"确定"
   - 新句子插入到指定位置

2. **合并音频**
   - 在任务详情页
   - 勾选需要合并的句子
   - 点击"合并音频"按钮
   - 显示合并进度
   - 合并完成后显示合并音频播放器
   - 支持下载合并后的音频

3. **音频播放**
   - 每个句子有独立的音频播放器
   - 支持播放、暂停、进度控制
   - 显示音频时长
   - 支持下载单个句子音频

---

### 2.9 音色管理模块

#### 界面布局推测
- **音色选择器**: 下拉菜单或弹窗
- **音色列表**: 显示音色ID、名称、类型、推荐标记
- **音色预览**: 点击音色可试听

#### 交互流程
1. **选择音色**
   - 在参数调整面板
   - 点击音色选择器
   - 显示音色列表（推荐音色优先显示）
   - 显示音色类型（女声、男声等）
   - 点击音色可试听
   - 选择后应用到句子

2. **音色管理**
   - 在系统设置中
   - 显示所有可用音色
   - 支持标记推荐音色
   - 支持排序

---

## 三、页面结构推测

### 3.1 整体布局
```
┌─────────────────────────────────────────┐
│  顶部导航栏（Logo、用户信息、设置）      │
├─────────────────────────────────────────┤
│  侧边栏菜单                              │
│  - 任务列表                              │
│  - 音色管理                              │
│  - 阅读规范                              │
│  - 系统设置                              │
├─────────────────────────────────────────┤
│                                         │
│  主内容区                                │
│  - 任务列表/任务详情/句子详情            │
│  - 参数调整面板                          │
│  - 音频播放器                            │
│                                         │
└─────────────────────────────────────────┘
```

### 3.2 任务列表页
- 顶部：搜索框、筛选器、新建任务按钮
- 内容区：任务卡片列表（分页）
- 每个任务卡片：
  - 任务ID
  - 文本预览（前50字）
  - 字符数/句子数
  - 状态标签
  - 创建时间
  - 操作按钮（查看、删除）

### 3.3 任务详情页
- 顶部：返回按钮、任务信息（ID、状态、创建时间）
- 左侧：原始文本显示
- 中间：句子列表（可滚动）
- 右侧：合并音频播放器（如果已合成）
- 底部：操作按钮（批量合成、合并音频、应用阅读规范）

### 3.4 句子详情页
- 顶部：返回按钮、句子信息（序号、状态）
- 左侧：句子文本（可编辑，显示停顿和多音字标记）
- 中间：参数调整面板
- 右侧：音频播放器、停顿列表、多音字列表
- 底部：操作按钮（合成、重新合成、保存参数）

---

## 四、交互细节分析

### 4.1 状态反馈
- **加载状态**: 拆句、合成、合并时显示loading动画
- **成功提示**: 操作成功后显示toast提示
- **错误提示**: 操作失败显示错误信息弹窗
- **进度显示**: 批量操作显示进度条

### 4.2 实时更新
- **参数调整**: 滑块拖动时实时显示数值
- **音频播放**: 播放器实时显示播放进度
- **状态同步**: 合成状态变化时自动刷新界面

### 4.3 数据校验
- **文本长度**: 输入时显示字符数，超过2000字提示
- **参数范围**: 滑块限制在有效范围内
- **必填项**: 表单提交时校验必填项

### 4.4 响应式设计
- **移动端适配**: 原型显示为device模式，说明需要支持移动端
- **布局调整**: 小屏幕下侧边栏收起，主内容区全屏

---

## 五、技术实现要点

### 5.1 前端组件
基于Element Plus组件库：
- **表单组件**: el-input、el-select、el-slider
- **列表组件**: el-table、el-card
- **弹窗组件**: el-dialog、el-drawer
- **播放器组件**: 自定义音频播放器
- **状态组件**: el-tag、el-progress

### 5.2 状态管理
- **任务状态**: Vuex/Pinia管理任务列表和当前任务
- **句子状态**: 管理句子列表和当前句子
- **合成状态**: 管理合成任务和进度

### 5.3 音频处理
- **音频播放**: HTML5 Audio API
- **音频下载**: 通过URL下载音频文件
- **音频合并**: 后端处理，前端显示进度

### 5.4 实时通信
- **合成状态**: 轮询查询合成状态
- **批量操作**: WebSocket或轮询更新进度

---

## 六、用户体验优化建议

### 6.1 操作便捷性
- **快捷键**: 支持键盘快捷键操作
- **批量操作**: 支持批量选择和处理
- **撤销重做**: 支持操作历史记录

### 6.2 视觉反馈
- **状态颜色**: 不同状态使用不同颜色标识
- **动画效果**: 操作反馈使用平滑动画
- **图标提示**: 使用图标增强可读性

### 6.3 性能优化
- **懒加载**: 句子列表使用虚拟滚动
- **缓存机制**: 缓存已加载的任务和句子数据
- **防抖节流**: 参数调整使用防抖，避免频繁请求

### 6.4 错误处理
- **友好提示**: 错误信息使用用户友好的语言
- **重试机制**: 失败操作支持重试
- **离线提示**: 网络错误时提示用户

---

## 七、原型与API对应关系

### 7.1 页面与接口映射
| 页面/功能 | 对应API接口 |
|----------|------------|
| 创建任务 | POST /tasks |
| 任务列表 | GET /tasks |
| 任务详情 | GET /tasks?task_id={task_id} |
| 句子列表 | GET /tasks/sentences?task_id={task_id} |
| 句子详情 | GET /sentences?sentence_id={sentence_id} |
| 合成句子 | POST /sentences/{sentence_id}/synthesize |
| 批量合成 | POST /tasks/{task_id}/synthesize |
| 参数调整 | POST /sentences/settings |
| 添加停顿 | POST /sentences/{sentence_id}/pauses |
| 设置多音字 | POST /sentences/{sentence_id}/polyphonic |
| 合并音频 | POST /tasks/{task_id}/audio/merge |
| 音色列表 | GET /voices |
| 阅读规范 | POST /reading-rules |

### 7.2 数据流
1. **创建任务流程**:
   - 用户输入文本 → POST /tasks → 返回任务和句子列表 → 更新界面

2. **合成流程**:
   - 用户设置参数 → POST /sentences/{id}/synthesize → 返回task_id → 轮询查询状态 → 更新音频URL → 显示播放器

3. **参数调整流程**:
   - 用户调整参数 → POST /sentences/settings → 更新数据库 → 刷新句子详情 → 提示需要重新合成

---

## 八、总结

### 8.1 核心功能完整性
✅ 任务管理：创建、查看、列表
✅ 句子管理：列表、详情、编辑
✅ 语音合成：单个、批量、重新合成
✅ 参数调整：音色、语速、音量、音调
✅ 停顿静音：添加、查看、删除
✅ 多音字处理：设置、查看、删除
✅ 阅读规范：创建、应用、查看
✅ 音频编辑：插入句子、合并音频
✅ 音色管理：列表、选择、预览

### 8.2 技术实现可行性
✅ 前端技术栈明确（Vue.js + Element Plus）
✅ 后端API设计完整
✅ 数据库设计合理
✅ 交互流程清晰

### 8.3 待确认事项
- 原型中的具体UI设计细节
- 颜色方案和视觉风格
- 具体的交互动画效果
- 移动端的详细适配方案

---

**分析日期**: 2024年
**分析人**: AI Assistant
**文档版本**: v1.0

